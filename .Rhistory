rt(10, df=Inf)
set.seed(1)
rt(10, df=Inf)
set.seed(1)
rnorm(10)
#' @param rho dependence parameter
#' @param i seed
#' @param df degrees of freedom to be inserted into rt. df = 1 yields the Cauchy distribution and df = Inf the standard normal distribution
#'
#' @return
#' @export
#'
#' @examples
#'
#'
Gen_RegressionDGP <- function(n, rho, i, df){
set.seed(i)
# Generate nominal covariate and create continuous dependent variable via regression
X <- sample(c("A", "B", "C"), n, prob = c(1/3, 1/3, 1/3), replace = TRUE)
C_ind <- ifelse(X == "C", 1, 0)
B_ind <- ifelse(X == "B", 1, 0)
Y <- rho * B_ind - rho * C_ind + rt(n, df = df)
return(cbind(X, Y))
}
Gen_RegressionDGP(10, 1, 1, 1)
X, Y <- Gen_RegressionDGP(10, 1, 1, 1)
n <- 10
rho <- 1
i <- 1
Gen_RegressionDGP(n, rho, i, 1)
XY <- Gen_RegressionDGP(n, rho, i, 1)
XY[,1]
XY[,2]
gamma <- NCor(XY[,1], XY[,2], nominal = "r", CIs = FALSE, Test = FALSE)[[1]]
source(file = "/Users/lukaswermuth/Documents/Dr.Wermuth/Rpackages/NCor/R/NCor.R")
gamma <- NCor(XY[,1], XY[,2], nominal = "r", CIs = FALSE, Test = FALSE)[[1]]
library(doParallel)
gamma <- NCor(XY[,1], XY[,2], nominal = "r", CIs = FALSE, Test = FALSE)[[1]]
Setup_cluster()
#' @title Helper function: Setup cluster for parallel computing
#'
Setup_cluster <- function(){
cl <- makeCluster(detectCores() - 1, type = "PSOCK")
registerDoParallel(cl)
on.exit(parallel::stopCluster(cl))
}
Setup_cluster()
rm(list = ls())
source(file = "/Users/lukaswermuth/Documents/Dr.Wermuth/Rpackages/NCor/R/NCor.R")
invisible(lapply(list.files("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/code/functions", pattern = "\\.R$", full.names = TRUE), source))
rm(list = ls())
source(file = "/Users/lukaswermuth/Documents/Dr.Wermuth/Rpackages/NCor/R/NCor.R")
lapply(list.files("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/code/functions", pattern = "\\.R$", full.names = TRUE), source)
rm(list = ls())
source(file = "/Users/lukaswermuth/Documents/Dr.Wermuth/Rpackages/NCor/R/NCor.R")
invisible(lapply(list.files("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/code/functions", pattern = "\\.R$", full.names = TRUE), source))
results_folder <- "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/Results/Simulations/True_gammas"
paste(results_folder, "gammas_RegNorm.RData", sep = /)
paste(results_folder, "gammas_RegNorm.RData", sep = "/")
paste(results_folder, "gammas_RegNorm.RData", sep = "/")
## Regression DGP: Normal Innovations
load(file = "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/Results/Simulations/True_gammas/gammas_RegNorm.RData")
rm(list = ls())
source(file = "/Users/lukaswermuth/Documents/Dr.Wermuth/Rpackages/NCor/R/NCor.R")
TrueGammas_folder <- "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/True_gammas"
library(arrangements)
library(rstatix)
library(foreach)
library(readxl)
library(doParallel)
library(DescTools)
library(compositions)
library(mvtnorm)
paste(TrueGammas_folder, "gammas_RegNorm.RData", sep = "/")
## Regression DGP: Normal Innovations
load(file = paste(TrueGammas_folder, "gammas_RegNorm.RData", sep = "/"))
rm(list = ls())
source(file = "/Users/lukaswermuth/Documents/Dr.Wermuth/Rpackages/NCor/R/NCor.R")
invisible(lapply(list.files("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/True_gammas", pattern = "\\.R$", full.names = TRUE), load))
lapply(list.files("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/True_gammas", pattern = "\\.R$", full.names = TRUE), load)
lapply(list.files("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/True_gammas", pattern = "\\.R$", full.names = TRUE), load)
list.files("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/True_gammas", pattern = "\\.R$", full.names = TRUE)
rm(list = ls())
source(file = "/Users/lukaswermuth/Documents/Dr.Wermuth/Rpackages/NCor/R/NCor.R")
lapply(list.files("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/True_gammas", pattern = "\\.RData$", full.names = TRUE), load)
rm(list = ls())
source(file = "/Users/lukaswermuth/Documents/Dr.Wermuth/Rpackages/NCor/R/NCor.R")
invisible(lapply(list.files("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/True_gammas", pattern = "\\.RData$", full.names = TRUE), load))
rm(list = ls())
source(file = "/Users/lukaswermuth/Documents/Dr.Wermuth/Rpackages/NCor/R/NCor.R")
invisible(lapply(list.files("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/True_gammas", pattern = "\\.RData$", full.names = TRUE), function(x) load(x, envir = globalenv())))
aste(results_folder, "RegNormal_CIs.RData", sep = "/")
paste(results_folder, "RegNormal_CIs.RData", sep = "/")
rm(list = ls())
source(file = "/Users/lukaswermuth/Documents/Dr.Wermuth/Rpackages/NCor/R/NCor.R")
invisible(lapply(list.files("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/True_gammas", pattern = "\\.RData$", full.names = TRUE), function(x) load(x, envir = globalenv())))
results_folder <- "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/Coverage"
paste(results_folder, "RegNormal_CIs.RData", sep = "/")
rm(list = ls())
source(file = "/Users/lukaswermuth/Documents/Dr.Wermuth/Rpackages/NCor/R/NCor.R")
invisible(lapply(list.files("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/True_gammas", pattern = "\\.RData$", full.names = TRUE), function(x) load(x, envir = globalenv())))
results_folder <- "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/Coverage"
library(arrangements)
library(rstatix)
library(foreach)
library(readxl)
library(doParallel)
library(DescTools)
library(compositions)
library(mvtnorm)
# Parameter Specifications ------------------------------------------------
MC <- 1000
SampleSizes <- c(50, 200, 800)
categories <- c("A", "B", "C")
paste(results_folder, "3x3SU_CIs.RData", sep = "/")
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/RegNormal_pval.RData")
pval_wermuth_array
dimnames(pval_wermuth_array)
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/RegNormal_pval.RData")
dimnames(pval_wermuth_array)
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/RegNormal_pval_power.RData")
dimnames(pval_wermuth_array)
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/RegNormal_pval_power.RData")
dimnames(pval_wermuth_array)
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/RegNormal_pval_power.RData")
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/RegNormal_pval.RData")
dimnames(pval_wermuth_array)
pval_wermuth_array[,,"0"]
pval_wermuth_array[,,"0"]
pval_wermuth_array_indep <- pval_wermuth_array[,,"0"]
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/RegNormal_pval_power.RData")
pval_wermuth_RegNorm <- abind(pval_wermuth_array_indep, pval_wermuth_array, along = 3)
library(abind)
dimnames(pval_wermuth_array)
dimnames(pval_wermuth_array_indep)
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/RegNormal_pval.RData")
dimnames(pval_wermuth_array)
dimnames(pval_wermuth_array)
dimnames(pval_wermuth_array[,,1])
dimnames(pval_wermuth_array[,,1, drop = FALSE])
pval_wermuth_array_indep <- pval_wermuth_array[,,1, drop = FALSE]
dimnames(pval_wermuth_array_indep)
dimnames(pval_wermuth_array_indep)
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/RegNormal_pval_power.RData")
dimnames(pval_wermuth_array)
pval_wermuth_RegNorm <- abind(pval_wermuth_array_indep, pval_wermuth_array, along = 3)
dimnames(pval_wermuth_RegNorm)
save(pval_wermuth_RegNorm, file = "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/RegNormal_pval.RData")
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/RegNormal_pval.RData")
dimnames(pval_wermuth_RegNorm)
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/RegNormal_pval_reg.RData")
pval_wermuth_array_indep <- pval_wermuth_array[,,1, drop = FALSE]
pval_reg_array_indep <- pval_reg_array[,,1, drop = FALSE]
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/RegNormal_pval_reg_power.RData")
dimnames(pval_reg_array_indep)
dimnames(pval_reg_array)
pval_reg_RegNorm <- abind(pval_reg_array_indep, pval_reg_array, along = 3)
dimnames(pval_reg_RegNorm)
dimnames(pval_reg_RegNorm)
save(pval_reg_RegNorm, file = "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/RegNormal_pval_reg.RData")
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/RegCauchy_pval.RData")
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/RegCauchy_pval_reg.RData")
pval_reg_array_indep <- pval_reg_array[,,1, drop = FALSE]
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/RegCauchy_pval_reg_power.RData")
dimnames(pval_reg_array)
dimnames(pval_reg_array_indep)
pval_reg_RegCauchy <- abind(pval_reg_array_indep, pval_reg_array, along = 3)
dimnames(pval_reg_RegCauchy)
save(pval_reg_RegCauchy, file = "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/RegCauchy_pval_reg.RData")
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/MultNorm_pval_reg.RData")
pval_reg_array_indep <- pval_reg_array[,,1, drop = FALSE]
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/MultNorm_pval_reg_power.RData")
pval_reg_MultNorm <- abind(pval_reg_array_indep, pval_reg_array, along = 3)
dimnames(pval_reg_MultNorm)
save(pval_reg_MultNorm, file = "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/MultNorm_pval_reg.RData")
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/MultCauchy_pval_reg.RData")
pval_reg_array_indep <- pval_reg_array[,,1, drop = FALSE]
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/MultCauchy_pval_reg_power.RData")
pval_reg_MultCauchy <- abind(pval_reg_array_indep, pval_reg_array, along = 3)
dimnames(pval_reg_MultCauchy)
save(pval_reg_MultCauchy, file = "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/MultCauchy_pval_reg.RData")
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/RegCauchy_pval.RData")
pval_wermuth_array_indep <- pval_wermuth_array[,,1, drop = FALSE]
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/RegCauchy_pval_power.RData")
pval_wermuth_RegCauchy <- abind(pval_wermuth_array_indep, pval_wermuth_array, along = 3)
dimnames(pval_wermuth_RegCauchy)
save(pval_wermuth_RegCauchy, file = "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/RegCauchy_pval.RData")
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/MultNorm_pval.RData")
pval_wermuth_array_indep <- pval_wermuth_array[,,1, drop = FALSE]
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/MultNorm_pval_power.RData")
pval_wermuth_MultNorm <- abind(pval_wermuth_array_indep, pval_wermuth_array, along = 3)
dimnames(pval_wermuth_MultNorm)
save(pval_wermuth_MultNorm, file = "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/MultNorm_pval.RData")
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/MultCauchy_pval.RData")
pval_wermuth_array_indep <- pval_wermuth_array[,,1, drop = FALSE]
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/MultCauchy_pval_power.RData")
pval_wermuth_MultCauchy <- abind(pval_wermuth_array_indep, pval_wermuth_array, along = 3)
dimnames(pval_wermuth_MultCauchy)
save(pval_wermuth_MultCauchy, file = "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/MultCauchy_pval.RData")
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomNom/3x3wermuth_pval_uniform.RData")
dimnames(pval_wermuth_array)
pval_wermuth_array_indep <- pval_wermuth_array[,,1, drop = FALSE]
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomNom/3x3wermuth_pval_uniform_power.RData")
dimnames(pval_wermuth_array)
pval_wermuth_3x3uniform <- abind(pval_wermuth_array_indep, pval_wermuth_array, along = 3)
save(pval_wermuth_3x3uniform, file = "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/3x3wermuth_uniform_pval.RData")
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomNom/3x3wermuth_pval.RData")
pval_wermuth_array_indep <- pval_wermuth_array[,,1, drop = FALSE]
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomNom/3x3wermuth_pval_power.RData")
pval_wermuth_3x3 <- abind(pval_wermuth_array_indep, pval_wermuth_array, along = 3)
dimnames(pval_wermuth_3x3)[[3]]
save(pval_wermuth_3x3, file = "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/3x3wermuth_pval.RData")
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomNom/3x3gtest_pval_uniform.RData")
pval_gtest_array_indep <- pval_gtest_array[,,1, drop = FALSE]
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomNom/3x3gtest_pval_uniform_power.RData")
pval_gtest_3x3_uniform <- abind(pval_gtest_array_indep, pval_gtest_array, along = 3)
dimnames(pval_gtest_3x3_uniform)[[3]]
save(pval_gtest_3x3_uniform, file = "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/3x3gtest_pval.RData")
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomNom/3x3gtest_pval.RData")
pval_gtest_array_indep <- pval_gtest_array[,,1, drop = FALSE]
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomNom/3x3gtest_pval_power.RData")
pval_gtest_3x3 <- abind(pval_gtest_array_indep, pval_gtest_array, along = 3)
save(pval_gtest_3x3, file = "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/3x3gtest_pval.RData")
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomNom/3x3chisq_pval_uniform.RData")
pval_chisq_array_indep <- pval_chisq_array[,,1, drop = FALSE]
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomNom/3x3chisq_pval_uniform_power.RData")
pval_chisq_3x3_uniform <- abind(pval_chisq_array_indep, pval_chisq_array, along = 3)
save(pval_chisq_3x3_uniform, file = "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/3x3chisq_pval_uniform.RData")
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomNom/3x3chisq_pval.RData")
pval_chisq_array_indep <- pval_chisq_array[,,1, drop = FALSE]
load("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomNom/3x3chisq_pval_power.RData")
pval_chisq_3x3 <- abind(pval_chisq_array_indep, pval_chisq_array, along = 3)
save(pval_chisq_3x3, file = "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest_NomCont/3x3chisq_pval.RData")
################################# Plots: Simulations #########################################
rm(list = ls())
library(ggplot2)
library(tidyr)
library(Cairo)
library(abind)
library(dplyr)
library(ks)
library(purrr)
library(latex2exp)
DGPs <- c("Regression Normal", "Regression Cauchy", "Multinomial Logit Normal", "Multinomial Logit Cauchy", "3 x 3 Skewed Uniform", "3 x 3 Uniform Uniform")
SampleSizes <- c("50", "200", "800")
results_folder <- "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Plots"
# Load Coverages ----------------------------------------------------------
load(file = "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/Results/Simulations/Coverage/RegNormal_CIs.RData")
coverage_folder <- "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/Coverage"
# Load Coverages ----------------------------------------------------------
load(file = paste(coverage_folder, "RegNormal_CIs.RData", sep = "/"))
################################# Plots: Simulations #########################################
rm(list = ls())
library(ggplot2)
library(tidyr)
library(Cairo)
library(abind)
library(dplyr)
library(ks)
library(purrr)
library(latex2exp)
DGPs <- c("Regression Normal", "Regression Cauchy", "Multinomial Logit Normal", "Multinomial Logit Cauchy", "3 x 3 Skewed Uniform", "3 x 3 Uniform Uniform")
SampleSizes <- c("50", "200", "800")
results_folder <- "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Plots"
coverage_folder <- "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/Coverage"
# Load Coverages ----------------------------------------------------------
load(file = paste(coverage_folder, "RegNormal_CIs.RData", sep = "/"))
coverage_wermuth_array_RegNormal <- decision_wermuth_array
load(file = paste(coverage_folder, "RegCauchy_CIs.RData", sep = "/"))
coverage_wermuth_array_RegCauchy <- decision_wermuth_array
load(file = paste(coverage_folder, "MultNorm_CIs.RData", sep = "/"))
coverage_wermuth_array_MultNormal <- decision_wermuth_array
load(file = paste(coverage_folder, "MultCauchy_CIs.RData", sep = "/"))
coverage_wermuth_array_MultCauchy <- decision_wermuth_array
load(file = paste(coverage_folder, "3x3SU_CIs.RData", sep = "/"))
coverage_wermuth_array_3x3_SU <- decision_wermuth_array
load(file = paste(coverage_folder, "3x3UU_CIs.RData", sep = "/"))
coverage_wermuth_array_3x3_UU <- decision_wermuth_array
invisible(lapply(list.files("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/True_gammas", pattern = "\\.RData$", full.names = TRUE), function(x) load(x, envir = globalenv())))
rm(list = ls())
source(file = "/Users/lukaswermuth/Documents/Dr.Wermuth/Rpackages/NCor/R/NCor.R")
invisible(lapply(list.files("/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/code/functions", pattern = "\\.R$", full.names = TRUE), source))
results_folder <- "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/True_gammas"
library(arrangements)
library(rstatix)
library(foreach)
library(readr)
library(readxl)
library(haven)
library(doParallel)
library(DescTools)
library(compositions)
library(mvtnorm)
rm(list = ls())
library(ggplot2)
library(tidyr)
library(Cairo)
library(abind)
library(dplyr)
library(ks)
library(purrr)
# Parameter Specification -------------------------------------------------
results_folder <- "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Plots"
sizepower_folder <- "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest"
# Load Size/Power Values for Gamma*-Test --------------------------------------------------
load(file = paste(sizepower_folder, "RegNormal_pval.RData", sep = "/"))
pval_wermuth_array_RegNormal <- as.data.frame(as.table(pval_wermuth_array)) %>% mutate(DGP = "Regression Normal") %>% rename(SampleSize = Var1, MC = Var2, rho = Var3)
rm(list = ls())
library(ggplot2)
library(tidyr)
library(Cairo)
library(abind)
library(dplyr)
library(ks)
library(purrr)
# Parameter Specification -------------------------------------------------
results_folder <- "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Plots"
sizepower_folder <- "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest"
# Load Size/Power Values for Gamma*-Test --------------------------------------------------
load(file = paste(sizepower_folder, "RegNormal_pval.RData", sep = "/"))
# Load Size/Power Values for Gamma*-Test --------------------------------------------------
load(file = paste(sizepower_folder, "RegNormal_pval.RData", sep = "/"))
pval_wermuth_array_RegNormal <- as.data.frame(as.table(pval_wermuth_RegNorm)) %>% mutate(DGP = "Regression Normal") %>% rename(SampleSize = Var1, MC = Var2, rho = Var3)
load(file = paste(sizepower_folder, "RegCauchy_pval.RData", sep = "/"))
# Parameter Specification -------------------------------------------------
results_folder <- "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Plots"
sizepower_folder <- "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest"
# Load Size/Power Values for Gamma*-Test --------------------------------------------------
load(file = paste(sizepower_folder, "RegNormal_pval.RData", sep = "/"))
pval_wermuth_array_RegNormal <- as.data.frame(as.table(pval_wermuth_RegNorm)) %>% mutate(DGP = "Regression Normal") %>% rename(SampleSize = Var1, MC = Var2, rho = Var3)
load(file = paste(sizepower_folder, "RegCauchy_pval.RData", sep = "/"))
pval_wermuth_array_RegCauchy <- as.data.frame(as.table(pval_wermuth_RegCauchy)) %>% mutate(DGP = "Regression Cauchy") %>% rename(SampleSize = Var1, MC = Var2, rho = Var3)
load(file = paste(sizepower_folder, "MultNorm_pval.RData", sep = "/"))
pval_wermuth_array_MultNorm <- as.data.frame(as.table(pval_wermuth_MultNorm)) %>% mutate(DGP = "Multinomial Logit Normal") %>% rename(SampleSize = Var1, MC = Var2, rho = Var3)
load(file = paste(sizepower_folder, "MultCauchy_pval.RData", sep = "/"))
pval_wermuth_array_MultCauchy <- as.data.frame(as.table(pval_wermuth_MultCauchy)) %>% mutate(DGP = "Multinomial Logit Cauchy") %>% rename(SampleSize = Var1, MC = Var2, rho = Var3)
load(file = paste(sizepower_folder, "3x3wermuth_pval.RData", sep = "/"))
load(file = paste(sizepower_folder, "3x3wermuth_pval.RData", sep = "/"))
pval_wermuth_array_3x3 <- as.data.frame(as.table(pval_wermuth_3x3)) %>% mutate(DGP = "3 x 3 Skewed Uniform") %>% rename(SampleSize = Var1, MC = Var2, rho = Var3)
load(file = paste(sizepower_folder, "3x3wermuth_pval_uniform.RData", sep = "/"))
pval_wermuth_array_3x3_uniform <- as.data.frame(as.table(pval_wermuth_3x3_uniform)) %>% mutate(DGP = "3 x 3 Uniform Uniform") %>% rename(SampleSize = Var1, MC = Var2, rho = Var3)
load(file = paste(sizepower_folder, "3x3wermuth_pval_uniform.RData", sep = "/"))
load(file = paste(sizepower_folder, "3x3wermuth_uniform_pval.RData", sep = "/"))
pval_wermuth_array_3x3_uniform <- as.data.frame(as.table(pval_wermuth_3x3_uniform)) %>% mutate(DGP = "3 x 3 Uniform Uniform") %>% rename(SampleSize = Var1, MC = Var2, rho = Var3)
# Load Size/Power Values for Gamma*-Test --------------------------------------------------
load(file = paste(sizepower_folder, "RegNormal_pval.RData", sep = "/"))
pval_wermuth_array_RegNormal <- as.data.frame(as.table(pval_wermuth_RegNorm)) %>% mutate(DGP = "Regression Normal") %>% rename(SampleSize = Var1, MC = Var2, rho = Var3)
load(file = paste(sizepower_folder, "RegCauchy_pval.RData", sep = "/"))
pval_wermuth_array_RegCauchy <- as.data.frame(as.table(pval_wermuth_RegCauchy)) %>% mutate(DGP = "Regression Cauchy") %>% rename(SampleSize = Var1, MC = Var2, rho = Var3)
load(file = paste(sizepower_folder, "MultNorm_pval.RData", sep = "/"))
pval_wermuth_array_MultNorm <- as.data.frame(as.table(pval_wermuth_MultNorm)) %>% mutate(DGP = "Multinomial Logit Normal") %>% rename(SampleSize = Var1, MC = Var2, rho = Var3)
load(file = paste(sizepower_folder, "MultCauchy_pval.RData", sep = "/"))
pval_wermuth_array_MultCauchy <- as.data.frame(as.table(pval_wermuth_MultCauchy)) %>% mutate(DGP = "Multinomial Logit Cauchy") %>% rename(SampleSize = Var1, MC = Var2, rho = Var3)
load(file = paste(sizepower_folder, "3x3wermuth_pval.RData", sep = "/"))
pval_wermuth_array_3x3 <- as.data.frame(as.table(pval_wermuth_3x3)) %>% mutate(DGP = "3 x 3 Skewed Uniform") %>% rename(SampleSize = Var1, MC = Var2, rho = Var3)
load(file = paste(sizepower_folder, "3x3wermuth_uniform_pval.RData", sep = "/"))
pval_wermuth_array_3x3_uniform <- as.data.frame(as.table(pval_wermuth_3x3_uniform)) %>% mutate(DGP = "3 x 3 Uniform Uniform") %>% rename(SampleSize = Var1, MC = Var2, rho = Var3)
load(file = paste(sizepower_folder, "3x3wermuth_uniform_pval.RData", sep = "/"))
pval_wermuth_array_3x3_uniform <- as.data.frame(as.table(pval_wermuth_3x3uniform)) %>% mutate(DGP = "3 x 3 Uniform Uniform") %>% rename(SampleSize = Var1, MC = Var2, rho = Var3)
# Facet_grid Preparation --------------------------------------------------
pval_wermuth_array <- rbind(pval_wermuth_array_RegNormal, pval_wermuth_array_RegCauchy, pval_wermuth_array_MultNorm, pval_wermuth_array_MultCauchy, pval_wermuth_array_3x3, pval_wermuth_array_3x3_uniform)
pval_wermuth_array$SampleSize <- as.numeric(as.character(pval_wermuth_array$SampleSize))
pval_wermuth_array$SampleSize <- replace(pval_wermuth_array$SampleSize, pval_wermuth_array$SampleSize == 50, "n = 50")
pval_wermuth_array$SampleSize <- replace(pval_wermuth_array$SampleSize, pval_wermuth_array$SampleSize == 200, "n = 200")
pval_wermuth_array$SampleSize <- replace(pval_wermuth_array$SampleSize, pval_wermuth_array$SampleSize == 800, "n = 800")
pval_wermuth_array$DGP <- factor(pval_wermuth_array$DGP, levels = c("Regression Normal", "Regression Cauchy", "Multinomial Logit Normal", "Multinomial Logit Cauchy", "3 x 3 Skewed Uniform", "3 x 3 Uniform Uniform"))
pval_wermuth_array$SampleSize <- factor(pval_wermuth_array$SampleSize, levels = c("n = 50", "n = 200", "n = 800"))
pval_wermuth_array_0 <- pval_wermuth_array %>% subset(rho == 0)
pval_wermuth_array_03 <- pval_wermuth_array %>% subset(rho == 0.3 | rho == 0.01)
pval_wermuth_array_06 <- pval_wermuth_array %>% subset(rho == 0.6)
kde_data <- pval_wermuth_array_0 %>%
group_split(DGP, SampleSize) %>%  # Split data by both groups
map(\(.x) {
kde_fit <- kde.boundary(.x$Freq, xmin = 0, xmax = 1)  # Compute KDE
data.frame(
DGP = unique(.x$DGP),
SampleSize = unique(.x$SampleSize),
x = kde_fit$eval.points,
y = kde_fit$estimate
)
}) %>%
list_rbind() %>%  # Combine all KDE data
filter(x > 0.05 & x < 0.95)  # Restrict KDE range
ggplot(pval_wermuth_array_0, aes(x = Freq)) +
geom_histogram(breaks = seq(0, 1, by = 0.1), fill = "skyblue", color = "black", aes(y = after_stat(density))) +
geom_line(data = kde_data, aes(x = x, y = y, group = interaction(DGP, SampleSize)), color = "red", linewidth = 1.2) +
facet_grid(cols = vars(SampleSize), rows = vars(DGP)) +
theme_bw() + theme(panel.spacing = unit(0.9, "lines")) +
labs(x = "P-Value", y = "Density")
rm(list = ls())
library(ggplot2)
library(tidyr)
library(Cairo)
library(abind)
library(dplyr)
library(ks)
library(purrr)
# Parameter Specification -------------------------------------------------
results_folder <- "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Plots"
sizepower_folder <- "/Users/lukaswermuth/Library/CloudStorage/Dropbox/Pohle Wermuth/NominalCorrelation/replication_NCor/results/Simulations/IndependenceTest"
# Load Size/Power Values for Gamma*-Test --------------------------------------------------
load(file = paste(sizepower_folder, "RegNormal_pval.RData", sep = "/"))
pval_wermuth_array_RegNormal <- as.data.frame(as.table(pval_wermuth_RegNorm)) %>% mutate(DGP = "Regression Normal") %>% rename(SampleSize = Var1, MC = Var2, rho = Var3)
load(file = paste(sizepower_folder, "RegCauchy_pval.RData", sep = "/"))
pval_wermuth_array_RegCauchy <- as.data.frame(as.table(pval_wermuth_RegCauchy)) %>% mutate(DGP = "Regression Cauchy") %>% rename(SampleSize = Var1, MC = Var2, rho = Var3)
load(file = paste(sizepower_folder, "MultNorm_pval.RData", sep = "/"))
pval_wermuth_array_MultNorm <- as.data.frame(as.table(pval_wermuth_MultNorm)) %>% mutate(DGP = "Multinomial Logit Normal") %>% rename(SampleSize = Var1, MC = Var2, rho = Var3)
load(file = paste(sizepower_folder, "MultCauchy_pval.RData", sep = "/"))
pval_wermuth_array_MultCauchy <- as.data.frame(as.table(pval_wermuth_MultCauchy)) %>% mutate(DGP = "Multinomial Logit Cauchy") %>% rename(SampleSize = Var1, MC = Var2, rho = Var3)
load(file = paste(sizepower_folder, "3x3wermuth_pval.RData", sep = "/"))
pval_wermuth_array_3x3 <- as.data.frame(as.table(pval_wermuth_3x3)) %>% mutate(DGP = "3 x 3 Skewed Uniform") %>% rename(SampleSize = Var1, MC = Var2, rho = Var3)
load(file = paste(sizepower_folder, "3x3wermuth_uniform_pval.RData", sep = "/"))
pval_wermuth_array_3x3_uniform <- as.data.frame(as.table(pval_wermuth_3x3uniform)) %>% mutate(DGP = "3 x 3 Uniform Uniform") %>% rename(SampleSize = Var1, MC = Var2, rho = Var3)
# Facet_grid Preparation --------------------------------------------------
pval_wermuth_array <- rbind(pval_wermuth_array_RegNormal, pval_wermuth_array_RegCauchy, pval_wermuth_array_MultNorm, pval_wermuth_array_MultCauchy, pval_wermuth_array_3x3, pval_wermuth_array_3x3_uniform)
pval_wermuth_array$SampleSize <- as.numeric(as.character(pval_wermuth_array$SampleSize))
pval_wermuth_array$SampleSize <- replace(pval_wermuth_array$SampleSize, pval_wermuth_array$SampleSize == 50, "n = 50")
pval_wermuth_array$SampleSize <- replace(pval_wermuth_array$SampleSize, pval_wermuth_array$SampleSize == 200, "n = 200")
pval_wermuth_array$SampleSize <- replace(pval_wermuth_array$SampleSize, pval_wermuth_array$SampleSize == 800, "n = 800")
pval_wermuth_array$DGP <- factor(pval_wermuth_array$DGP, levels = c("Regression Normal", "Regression Cauchy", "Multinomial Logit Normal", "Multinomial Logit Cauchy", "3 x 3 Skewed Uniform", "3 x 3 Uniform Uniform"))
pval_wermuth_array$SampleSize <- factor(pval_wermuth_array$SampleSize, levels = c("n = 50", "n = 200", "n = 800"))
pval_wermuth_array_0 <- pval_wermuth_array %>% subset(rho == 0)
kde_data <- pval_wermuth_array_0 %>%
group_split(DGP, SampleSize) %>%  # Split data by both groups
map(\(.x) {
kde_fit <- kde.boundary(.x$Freq, xmin = 0, xmax = 1)  # Compute KDE
data.frame(
DGP = unique(.x$DGP),
SampleSize = unique(.x$SampleSize),
x = kde_fit$eval.points,
y = kde_fit$estimate
)
}) %>%
list_rbind() %>%  # Combine all KDE data
filter(x > 0.05 & x < 0.95)  # Restrict KDE range
ggplot(pval_wermuth_array_0, aes(x = Freq)) +
geom_histogram(breaks = seq(0, 1, by = 0.1), fill = "skyblue", color = "black", aes(y = after_stat(density))) +
geom_line(data = kde_data, aes(x = x, y = y, group = interaction(DGP, SampleSize)), color = "red", linewidth = 1.2) +
facet_grid(cols = vars(SampleSize), rows = vars(DGP)) +
theme_bw() + theme(panel.spacing = unit(0.9, "lines")) +
labs(x = "P-Value", y = "Density")
rm(list = ls())
library(dplyr)
library(readxl)
library(arrangements)
library(NCor)
library(RCor)
library(doParallel)
rm(list = ls())
source(file = "/Users/lukaswermuth/Documents/Dr.Wermuth/Rpackages/NCor/R/NCor.R")
library(dplyr)
library(readxl)
library(arrangements)
library(NCor)
library(RCor)
library(doParallel)
rm(list = ls())
source(file = "/Users/lukaswermuth/Documents/Dr.Wermuth/Rpackages/NCor/R/NCor.R")
library(dplyr)
library(readxl)
library(arrangements)
library(NCor)
library(RCor)
library(doParallel)
usethis::use_github()
usethis::use_git_remote("origin", url = NULL, overwrite = TRUE)
usethis::use_github()
